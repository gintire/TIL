# Taints and Tolerations
* Taint -> nodeì— ì„¤ì •  
* Toleration -> Podì— ì„¤ì •

intoleration -> Taintëœ ë…¸ë“œì— ì ‘ê·¼ ë¶ˆê°€  
toleration ì´ ìˆìœ¼ë©´ Taintëœ ë…¸ë“œì— ì ‘ê·¼ ê°€ëŠ¥

## Taints - Node
`kubectl taint nodes node-name key=value:taint-effect` 
PODê°€ ìœ„ ì„¤ì •(value:taint-effect)ì— tolerateê°€ ì—†ìœ¼ë©´ ìƒê¸°ëŠ” ì¼€ì´ìŠ¤
* NoSchedule : podê°€ ë…¸ë“œì— ìŠ¤ì¼€ë“ˆ ë˜ì§€ ì•ŠìŒ. 
* PreferNoSchedule : ì‹œìŠ¤í…œì´ ë…¸ë“œì— podë¥¼ ìœ„ì¹˜í•˜ëŠ” ê²ƒì„ í”¼í•˜ë ¤ëŠ” ìƒíƒœ. í•˜ì§€ë§Œ ì´ê²ƒì€ ë³´ì¥(guaranteed)ë˜ì§€ ì•ŠëŠ”ë‹¤.
* NoExecute : ìƒˆë¡œìš´ podëŠ” ë…¸ë“œì— ìŠ¤ì¼€ì¥´ë˜ì§€ ì•Šê³ , ì´ë¯¸ ë…¸ë“œì— ì¡´ì¬í•˜ë˜ podëŠ” taintì— tolerateê°€ ì—†ëŠ” podë¼ë©´ í‡´ê±°(evicted)ëœë‹¤.
`kubectl taint nodes node1 app=blue:NoSchedule`

### Taint ì œê±°í•˜ê¸°
`kubectl taint nodes master/controlplane node-role.kubernetes.io/master:NoSchedule-`

## Tolerations - PODs
`kubectl taint nodes node1 app=blue:NoSchedule`  
ğŸ‘‡
[pod-definition.yml](../demo/taint_and_tolerations/pod-definition.yml)  
value ê°’ì„ ëª¨ë‘ ""(double quotation)ìœ¼ë¡œ ê°ì‹¸ì¤˜ì•¼í•œë‹¤. 
```
...
  tolerations:
    - key: "app"
      operator: "Equal"
      value: "blue"
      effect: "NoSchedule"
```

### Taint - NoExecute
![taint-noexecution1](../contents/taint-noexecution1.PNG)  
**C pod will be killed.**  
![taint-noexecution2](../contents/taint-noexecution.PNG)
 
 
Pod Dê°€ node1ì— tolerationì€ ìˆì§€ë§Œ í•­ìƒ Dê°€ node1ì— ìœ„ì¹˜í•œë‹¤ëŠ” ë³´ì¥ì€ ì—†ë‹¤.  
podê°€ ì–´ëŠ nodeì—ë§Œ í• ë‹¹ë˜ê²Œ í•˜ë ¤ë©´ `affinity`ë¼ëŠ” ê³„ë…ì„ ì‚¬ìš©í•œë‹¤.

ì§€ê¸ˆê¹Œì§€ëŠ” worker nodeì— ëŒ€í•´ì„œë§Œ ì•Œì•„ë´¤ëŠ”ë°, master nodeì—ë„ podê°€ í• ë‹¹ë  ìˆ˜ ìˆë‹¤.  
í•˜ì§€ë§Œ ë§ˆìŠ¤í„° ë…¸ë“œëŠ” ì´ˆê¸°ì— ìë™ìœ¼ë¡œ podê°€ ìŠ¤ì¼€ì¥´ë˜ì§€ ì•Šê²Œ ì„¤ì •ëœë‹¤. í•„ìš”ì‹œ ì„¤ì • ë³€ê²½ì´ ê°€ëŠ¥í•˜ë‹¤.
```
$ kubectl describe node kubemaster | grep Taint
Taints:             node-role.kubernetes.io/master:NoSchedule
```
Taint ì œê±°í•˜ê¸°  
`kubectl taint nodes master/controlplane node-role.kubernetes.io/master:NoSchedule-`

---
# Test
### taint ìƒì„±
`kubectl taint node node01 spray=morpein:NoSchedule'
